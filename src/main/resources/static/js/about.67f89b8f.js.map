{"version":3,"file":"js/about.67f89b8f.js","mappings":"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","sources":["webpack://dm-chat-ui/./src/views/Home.vue","webpack://dm-chat-ui/./src/api/websocket.js","webpack://dm-chat-ui/./src/views/Home.vue?9051"],"sourcesContent":["<template>\n  <div class=\"home\">\n    <el-container>\n      <el-header height=\"65px\" style=\"padding: 0\">\n        <el-row>\n          <h1>简易聊天室</h1>\n          <el-button type=\"primary\" @click=\"logout\">登出</el-button>\n        </el-row>\n        <el-row>\n          欢迎 {{ username }}\n        </el-row>\n      </el-header>\n      <el-main>\n        <div style=\"width: 800px\">\n          <el-row>\n            <p>toName<input type=\"text\" v-model=\"toName\"/></p>\n          </el-row>\n          <el-row>\n            <el-col :span=\"20\" class=\"msg-content\">\n              <el-scrollbar ref=\"scrollbarRef\" height=\"400px\" always @scroll=\"scroll\">\n                <div ref=\"innerRef\">\n                  <div v-for=\"item in msgList\" :key=\"item\" >\n                    <p v-if=\"item.fromName===this.username\" class=\"msg-send\"> 发送给{{ item.toName }}：{{ item.message }} </p>\n                    <p v-else class=\"msg-receive\"> 接收到{{ item.fromName }}：{{ item.message }} </p>\n                  </div>\n                </div>\n              </el-scrollbar>\n            </el-col>\n            <el-col :span=\"4\" class=\"msg-content\">\n              <el-button class=\"user-list-button\" v-for=\"user in userList\" :key=\"user\" @click=\"chooseUser(user.username)\">\n                {{ user.username }}\n              </el-button>\n            </el-col>\n          </el-row>\n          <el-row>\n            <el-input type=\"textarea\" :rows=\"2\" v-model=\"msg\"/>\n            <el-button type=\"primary\" @click=\"sendMsg\">发送</el-button>\n          </el-row>\n        </div>\n      </el-main>\n    </el-container>\n  </div>\n</template>\n\n<script>\nimport useWebsocket from \"../api/websocket\";\n\nexport default {\n  name: 'HomeView',\n  data() {\n    return {\n      ws: {},\n      username: '',\n      toName: '',\n      msg: '',\n      count: 10,\n      msgList: [],\n      userList: [\n        {\n          username: 'admin'\n        },\n        {\n          username: 'dm',\n        }\n      ],\n    }\n  },\n  methods: {\n    logout() {\n      console.log(\"username:\" + this.username)\n      this.ws.close()\n      // 保存用户名\n      localStorage.removeItem(\"username\");\n      // 跳转页面\n      this.$router.replace('/login')\n    },\n\n    sendMsg() {\n      let _msg = this.msg\n      if (!_msg.trim()) {\n        return;\n      }\n      let msgItem = {\n        fromName: this.username,\n        toName: this.toName,\n        message: this.msg\n      }\n      this.ws.send(JSON.stringify(msgItem))\n      //\n      this.msgList.push(msgItem);\n      // 滚动到底部\n      this.scrollAfterSend();\n      this.msg = '';\n    },\n\n    handleMessage(e) {\n      console.log(\"接收到数据：\", e);\n      let data = JSON.parse(e.data)\n      console.log(data);\n      this.msgList.push(data);\n      // 滚动到底部\n      this.scrollAfterSend();\n    },\n\n    // 发送消息后滚动到底部\n    scrollAfterSend() {\n      let innerHeight = this.$refs.innerRef.clientHeight\n      console.log(\"inner client height:\", innerHeight)\n      this.$nextTick(() => {\n        this.$refs.scrollbarRef.setScrollTop(innerHeight - 320)\n      })\n    },\n\n    chooseUser(username) {\n      console.log(\"username：\", username)\n      this.toName = username;\n    },\n\n    scroll(value) {\n      console.log(value)\n    },\n  },\n  created() {\n    this.username = localStorage.getItem(\"username\")\n    this.ws = useWebsocket(this.handleMessage, localStorage.getItem(\"username\"));\n  }\n}\n</script>\n\n<style scoped>\n.msg-content {\n  border: 1px solid black;\n}\n\n.user-list-button {\n  width: 100%;\n  margin-left: 0;\n  /*background-color: aqua;*/\n}\n\n.msg-send {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 50px;\n  margin: 10px;\n  text-align: center;\n  border-radius: 4px;\n  background: greenyellow;\n  color: black;\n}\n\n.msg-receive {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 50px;\n  margin: 10px;\n  text-align: center;\n  border-radius: 4px;\n  background: var(--el-color-primary-light-9);\n  color: var(--el-color-primary);\n}\n</style>\n","function useWebsocket(handleMessage, username) {\r\n    const ws = new WebSocket('ws://localhost:18080/chat/' + username);\r\n\r\n    const init = () => {\r\n        ws.addEventListener('open', handleOpen, false);\r\n        ws.addEventListener('close', handleClose, false);\r\n        ws.addEventListener('error', handleError, false);\r\n        ws.addEventListener('message', handleMessage, false);\r\n    };\r\n\r\n    function handleOpen(e) {\r\n        console.log('WebSocket open', e);\r\n    }\r\n\r\n    function handleClose(e) {\r\n        console.log('WebSocket close', e);\r\n    }\r\n\r\n    function handleError(e) {\r\n        console.log('WebSocket error', e);\r\n    }\r\n\r\n    init();\r\n\r\n    return ws;\r\n}\r\n\r\nexport default useWebsocket;","import { render } from \"./Home.vue?vue&type=template&id=a3ad5f7c&scoped=true\"\nimport script from \"./Home.vue?vue&type=script&lang=js\"\nexport * from \"./Home.vue?vue&type=script&lang=js\"\n\nimport \"./Home.vue?vue&type=style&index=0&id=a3ad5f7c&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\JetBrains\\\\WebStorm Project\\\\dm-chat-ui\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-a3ad5f7c\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","style","ref","_createElementBlock","_createVNode","_component_el_container","_component_el_header","height","_component_el_row","_hoisted_2","_component_el_button","type","onClick","$options","_toDisplayString","$data","_component_el_main","$event","_component_el_col","span","_component_el_scrollbar","always","onScroll","_Fragment","_renderList","item","key","fromName","username","toName","message","user","_createBlock","_component_el_input","rows","useWebsocket","handleMessage","ws","WebSocket","init","addEventListener","handleOpen","handleClose","handleError","e","console","log","name","data","msg","count","msgList","userList","methods","logout","this","close","localStorage","removeItem","$router","replace","sendMsg","_msg","trim","msgItem","send","JSON","stringify","push","scrollAfterSend","parse","innerHeight","$refs","innerRef","clientHeight","$nextTick","scrollbarRef","setScrollTop","chooseUser","scroll","value","created","getItem","__exports__","render"],"sourceRoot":""}